<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Cash Tow Me â€“ Driver</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAbB10Wg4OrZFEXV0JP9cQRHiy5-31Eiz4",
      authDomain: "cash-tow-me.firebaseapp.com",
      projectId: "cash-tow-me",
      storageBucket: "cash-tow-me.firebasestorage.app",
      messagingSenderId: "238625161564",
      appId: "1:238625161564:web:6907905ea88aef4f1f8199"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>

  <style>
    body { font-family: Arial; padding:20px; text-align:center; }
    input, button { width:90%; padding:10px; margin:8px 0; }
    button { background:#007bff; color:white; border:none; cursor:pointer; }
    button:hover { opacity:0.9; }
    .card { margin-top:15px; padding:10px; border:1px solid #ddd; }
  </style>
</head>

<body>

<h2>ðŸš› Cash Tow Me â€“ Driver</h2>

<input id="name" placeholder="Driver Name">
<input id="city" placeholder="City">
<input id="truck" placeholder="Truck Type">
<button onclick="addDriver()">Add Driver</button>

<br><br>
<button onclick="openAdmin()">Admin Panel</button>

<h3>Approved Drivers</h3>
<div id="approved"></div>

<h3>Pending Drivers</h3>
<div id="pending"></div>

<script>

function toggleStatus(id, currentStatus) {
  const newStatus = currentStatus === "ON" ? "OFF" : "ON";

  db.collection("drivers").doc(id).update({
    status: newStatus
  }).then(loadDrivers);
}

  }

  db.collection("drivers").add({
    name,
    city,
    truck,
    status: "OFF",
    approved: false,
    createdAt: Date.now()
  }).then(() => {
    alert("Driver submitted for approval");
    document.getElementById("name").value = "";
    document.getElementById("city").value = "";
    document.getElementById("truck").value = "";
    loadDrivers();
  });
}

function loadDrivers() {
  const approvedDiv = document.getElementById("approved");
  const pendingDiv = document.getElementById("pending");

  approvedDiv.innerHTML = "";
  pendingDiv.innerHTML = "";

  db.collection("drivers").get().then(snapshot => {
    snapshot.forEach(doc => {
      const d = doc.data();

      if (d.approved) {
    approvedDiv.innerHTML += `
  <div class="card">
    <strong>${d.name}</strong> - ${d.city}<br>
    Status: <strong>${d.status}</strong><br>
    <button onclick="toggleStatus('${doc.id}', '${d.status}')">
      Turn ${d.status === "ON" ? "OFF" : "ON"}
    </button>
  </div>
`;

      }
    });
  });
}

function approveDriver(id) {
  db.collection("drivers").doc(id).update({
    approved: true
  }).then(loadDrivers);
}

function openAdmin() {
  if (prompt("Admin password") === "admin123") {
    loadDrivers();
  } else {
    alert("Wrong password");
  }
}

loadDrivers();

</script>

</body>
</html>
